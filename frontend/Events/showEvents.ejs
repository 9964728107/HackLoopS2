<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Colony Management</title>

  <!-- Google fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Merriweather&family=Montserrat:ital@1&family=Sacramento&family=Ubuntu&display=swap"
    rel="stylesheet">

  <!-- CSS Stylesheet -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <link rel="stylesheet" href="frontend/css/home.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Bootstrap scripts -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style>
    body {

      font-family: 'Montserrat';
    }

    #title {
     background: linear-gradient(to right, #9b59b6, #e74c3c);
      color: #fff;
    }

    .container-fluid {
      padding: 3% 15% 7%;
    }

    h1 {
      font-family: 'Montserrat-Black', sans-serif;
      font-size: 3.5rem;
      line-height: 1.5;

    }

    h2 {
      font-family: " montserrat-bold";
      font-size: 3rem;
      line-height: 3rem;

    }

    .card img {
      width: auto;
      height: 240px;
    }


    h1 {
      font-size: 3.0rem;
    }

    h3 {
      font-family: "montserrat-bold";
      font-size: 1.5rem;
    }

    p {
      color: #8f8f8f;
    }

    /* Navigation Bar */
    .navbar {
      padding: 0 0 4.5rem;

    }

    .navbar-brand {
      font-family: "ubuntu";
      font-size: 2.0rem;
      font-weight: bold;
    }

    .nav-item {
      padding: 0 18px;
    }

    .nav-link {
      font-size: 1.2rem;
      font-family: "montserrat-light";
    }

    /* Download Buttons */
    .download-button {
      margin: 5% 3% 5% 0;
    }

    /* testimonials */
    #testimonials {
      text-align: center;
      background-color: #ef8172;
      color: white;
    }

    .padding {
      padding: 7% 15%;

    }

    .testimonial-image {
      width: 10%;
      border-radius: 100%;
    }


    /* Footer */
    #footer {
      padding: 4% 4%;
      text-align: center;
      color: white;

    }
  </style>
</head>

<body>

  <section id="title">
    <div class="container-fluid">

      <!-- Nav Bar -->
      <nav class="navbar navbar-expand-lg navbar-dark ">
        <a class="navbar-brand" href="/">MyCommunity</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01"
          aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/event">Events &amp; Issues</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/createProfile">Profile</a>
            </li>
            <% if (!user) { %>
              <li class="nav-item">
                <a class="nav-link" href="/login">Login</a>
              </li>
              <% } else { %>
                <li class="nav-item">
                  <a class="nav-link" href="/logout">Logout</a>
                </li>
                <% } %>
      
      
          </ul>
        </div>
      
      </nav>

      <!-- flash messages will be here -->
      <% if( success && success.length){ %>

        <div class="alert alert-success alert-dismissible fade show col-6 offset-3" role="alert">
          <%= success %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <% } %>
          <% if( error &&error.length){ %>

            <div class="alert alert-danger alert-dismissible fade show col-6 offset-3" role="alert">
              <%= error %>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>

            <% } %>




              <!-- Testimonials -->




              <div class="container mt-5  ">
                <!-- <h1 class="navbar-dark">Upcoming Events</h1> -->
                <% if (events.length==0) { %>
                  <h2>No Events added yet :(</h2>
                  <% } %>

                  <h2>Events</h2>
                  <br>
                    <!-- Add Event Button -->
                    <form method="get" action="/addevent">
                      <button class="btn btn-dark mb-3">ADD EVENT &nbsp; <i class="fa fa-handshake"
                          aria-hidden="true"></i></button>
                    </form>
                    <!-- Event Cards -->
                    <div class="card-deck">
                      <% events.forEach(event=> { %>
                        <div class="card">
                          <!-- Event Image (if available) -->
                          <% if (event.image) { %>
                            <!-- <img src="<%= //event.image  %>" class="card-img-top" alt="Event Image"> -->
                            <img src="/images/<%= event.image  %>" alt="trying some multer images">
                            <% } %>

                              <div style="padding-bottom: 10%;" class="card-body">
                                <h5 class="card-title">
                                  <%= event.Name %>
                                </h5>
                                <p class="card-text">
                                  <%= event.description %>
                                </p>
                                <p class="card-text"><small class="text-muted"><b>Event Date: </b> <%= event.date.toDateString()
                                      %></small></p>
                                <p class="card-text"><small class="text-muted"> <b>Location:</b> <%= event.location %></small>
                                </p>
                              </div>
                              <% if (  event.createdBy==user.id  || user.Type=="ADMIN") { %>
                              <form action="/event/<%= event.id %>?_method=DELETE" method="post">
                                <button style="margin-left: 30%; margin-bottom: 10%;" class="btn btn-dark ">
                                  Delete event
                                </button>
                              </form>
                              <% } %>
                              
                        </div>
                        <% }); %>
                    </div>
              </div>

              <br><br><br><br><br><br><br>
              <!-- Event Cards -->
              <h2>Issues</h2>
              <br>
              <form method="get" action="/issues/new">
                <button class="btn btn-dark mb-3">ADD ISSUE &nbsp; <i class="fa fa-handshake" aria-hidden="true"></i></button>
              </form>
              <% if (issues.length==0) { %>
                <h2>No issues yet :)</h2>
                <% } %>
                <% if (issues.length!=0) { %>
                  
               
              <div class="card-deck">
                <% issues.forEach(issue=> { %>
                  <div class="card">
                    <!-- Event Image (if available) -->
              
                        <div style="padding-bottom: 10%;" class="card-body">
                          <h5 class="card-title">
                            <%= issue.title %>  
                            <% if (issue.status=="Open") { %>
                            <b style="color: #ff4c68;">
                              <%= issue.status %>
                            </b>
                            <% } %>
                            <% if (issue.status=="In Progress") { %>
                              <b style="color: orange;">
                                <%= issue.status %>
                              </b>
                              <% } %>
                              <% if (issue.status=="Resolved") { %>
                                <b style="color: green;">
                                  <%= issue.status %>
                                </b>
                                <% } %>
                          </h5>
                          <p class="card-text">
                            <%= issue.description %>  
                          </p>
                          <p class="card-text"><small class="text-muted"> <b>opened on :</b> <%= issue.createdAt.toLocaleString() %></small></p>
                          <!-- <p><%= issue.id  %></p> -->
                          <p> <i class="fa fa-thumbs-up" style="font-size:24px;color: red;"></i> : <%= issue.upvote  %></p>
                          
                          </p>
                        </div>

                        
                        <% if ( user.Type=="ADMIN" || issue.createdBy==user.id) { %>
                        <form class="ms-4" action="/Issues/status/<%= issue.id %>?_method=PUT" method="post">
                          
                          <label for="issueStatus">Update</label>
                          <select id="issueStatus" name="issue[status]">
                            <option value="Open">Open</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Resolved">Resolved</option>
                          </select>
                          <button type="submit" class="btn-secondary btn-sm" >Ok</button>
                          </form>
                          <br><br>
                        
                            <% } %>
                        <form  class="ms-4"action="/Issues/upvote/<%= issue.id %>?_method=PUT" method="post">
                          <input type="hidden" name="_method" value="PUT">
                          <button style="     margin-bottom: -3%;
                          margin-top: -15%;
                          margin-left: 31%;" class="btn btn-dark ">
                            Upvote
                          </button>
                        </form>
                        <form class="ms-4" action="/Issues/<%= issue.id %>?_method=get" method="post">
                          <button style="   margin-left: 28%;
                          margin-bottom: 5%;
                          margin-top: -1%;" class="btn btn-primary ">
                            Know more
                          </button>
                        </form>
                        <% if ( user.Type=="ADMIN" ||issue.createdBy == user.id) { %>
                          <form  class="ms-3"action="/issue/<%= issue.id %>?_method=DELETE" method="post">
                            <button style="margin-left: 30%; margin-bottom: 10%;" class="btn btn-dark ">
                              Delete Issue
                            </button>
                         
                        <% } %>
                      
                        
                        </form>
                  </div>
                  <% }); %>
              </div>
                <% } %>
              </div>







              <!-- Bootstrap JS and Popper.js (required for Bootstrap components) -->
              <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
              <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
              <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>



